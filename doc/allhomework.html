<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yiming Ma" />

<meta name="date" content="2020-12-15" />

<title>All my homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All my homework</h1>
<h4 class="author">Yiming Ma</h4>
<h4 class="date">2020-12-15</h4>



<div id="section" class="section level1">
<h1>9.22</h1>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>x&lt;-<span class="kw">runif</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>y&lt;-<span class="kw">runif</span>(<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">6</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">plot</span>(x,y,<span class="dt">xlab =</span> <span class="st">&quot;ten random values&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;ten other random values&quot;</span>,<span class="dt">bg=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">22</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>tab &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="st">&quot;C:/rlearn/生产总值.xls&quot;</span>,<span class="dt">sheet=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...1</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(tab)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">…1</th>
<th align="left">指标名称</th>
<th align="left">地区名称</th>
<th align="left">指标单位</th>
<th align="right">2019年09月</th>
<th align="right">2019年12月</th>
<th align="right">2020年03月</th>
<th align="right">2020年06月</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">国内生产总值及产业结构(季度)</td>
<td align="left">国内生产总值(累计)</td>
<td align="left">全国</td>
<td align="left">亿元</td>
<td align="right">712845.4</td>
<td align="right">990865.1</td>
<td align="right">206504.3</td>
<td align="right">456614.4</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">国内生产总值(累计)同比增长率</td>
<td align="left">NA</td>
<td align="left">%</td>
<td align="right">6.2</td>
<td align="right">6.1</td>
<td align="right">-6.8</td>
<td align="right">-1.6</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">第一产业增加值(累计)</td>
<td align="left">NA</td>
<td align="left">亿元</td>
<td align="right">43005.0</td>
<td align="right">70466.7</td>
<td align="right">10186.2</td>
<td align="right">26053.0</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">第一产业增加值(累计)同比增长率</td>
<td align="left">NA</td>
<td align="left">%</td>
<td align="right">2.9</td>
<td align="right">3.1</td>
<td align="right">-3.2</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">第二产业增加值(累计)</td>
<td align="left">NA</td>
<td align="left">亿元</td>
<td align="right">276912.5</td>
<td align="right">386165.3</td>
<td align="right">73638.0</td>
<td align="right">172759.0</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">第二产业增加值(累计)同比增长率</td>
<td align="left">NA</td>
<td align="left">%</td>
<td align="right">5.6</td>
<td align="right">5.7</td>
<td align="right">-9.6</td>
<td align="right">-1.9</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">第三产业增加值(累计)</td>
<td align="left">NA</td>
<td align="left">亿元</td>
<td align="right">392927.9</td>
<td align="right">534233.1</td>
<td align="right">122680.1</td>
<td align="right">257802.4</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">第三产业增加值(累计)同比增长率</td>
<td align="left">NA</td>
<td align="left">%</td>
<td align="right">7.0</td>
<td align="right">6.9</td>
<td align="right">-5.2</td>
<td align="right">-1.6</td>
</tr>
</tbody>
</table>
<p>这是季度生产总值和产业结构的表格，数据来自中宏数据库</p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>如果我们定义风险的市场价格为 <span class="math display">\[
  \Theta(t)=\frac{\alpha(t)-R(t)}{\sigma(t)}
  \]</span> 在Girsanov Thearem中取<span class="math inline">\(L_{t} =-\int_{0}^{t} \Theta(u) d W(u)\)</span> ，因为 <span class="math display">\[
\langle \Theta \cdot W,\Theta \cdot W \rangle =\Theta^{2}\cdot\langle W,W\rangle 
\]</span> 那么得到 <span class="math display">\[
  Z_{t}=\mathscr{E}(L) =\exp \left(L_{t}-\frac{1}{2}\langle L, L\rangle_{t}\right)
  =\exp \left\{-\int_{0}^{t} \Theta(u) d W(u)-\frac{1}{2} \int_{0}^{t} \Theta^{2}(u) d u\right\}
  \]</span></p>
</div>
</div>
<div id="section-1" class="section level1">
<h1>9.29</h1>
<div id="exercise-3.3" class="section level2">
<h2>Exercise 3.3</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n&lt;-<span class="dv">5000</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb5-3"><a href="#cb5-3"></a>x&lt;-<span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">40</span>),<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">*</span>x<span class="op">^-</span><span class="dv">3</span>))</span>
<span id="cb5-5"><a href="#cb5-5"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">*</span>y<span class="op">^-</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>通过比较频率直方图和密度图发现基本吻合</p>
</div>
<div id="exercise-3.8-3.9" class="section level2">
<h2>Exercise 3.8 3.9</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>f&lt;-<span class="cf">function</span>(){</span>
<span id="cb6-2"><a href="#cb6-2"></a>u1&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>u2&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>u3&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>x&lt;-<span class="dv">1</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u2)<span class="op">&amp;&amp;</span><span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u1))</span>
<span id="cb6-7"><a href="#cb6-7"></a>    {x=u2}<span class="cf">else</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    x=u3</span>
<span id="cb6-9"><a href="#cb6-9"></a>}</span></code></pre></div>
<p>以上定义了一个生成符合分布抽样函数，下面通过该函数生产大模拟样本直方图</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>x&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">50000</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50000</span>) {</span>
<span id="cb7-3"><a href="#cb7-3"></a>  x[i]=<span class="kw">f</span>()</span>
<span id="cb7-4"><a href="#cb7-4"></a>  i=i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="dv">90</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb7-7"><a href="#cb7-7"></a>y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">lines</span>(y,<span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>发现密度曲线和大模拟样本直方图比较接近，可以认为该算法符合密度函数。</p>
</div>
<div id="exercise-3.9" class="section level2">
<h2>Exercise 3.9</h2>
<p>证明： 我们假定输出结果为一个新的随机变量<span class="math inline">\(U\)</span>，现在即要证明<span class="math inline">\(\textit{P}(U=x)=\frac{3}{4}\left(1-x^{2}\right)\)</span>,将该算法各种情况分开考虑 <span class="math display">\[
\begin{align}\textit{P}(U=x)&amp;=\textit{P}(U_2=x,|U_3|\ge|U_2|,|U_3|\ge|U_1|)+\textit{P}(U_3=x,|U_3| &lt; |U_2|,|U_3|\ge|U_1|)\\
&amp;+\textit{P}(U_3=x,|U_3|\ge|U_2|,|U_3|&lt;|U_1|)+\textit{P}(U_3=x,|U_3|&lt;|U_2|,|U_3|&lt;|U_1|)\\&amp;=0.25(1-x^2)+0.25(1-x)^2+0.25(1-x)^2+|x|(1-|x|)\\&amp;=0.75(1-x^2)
\end{align}
\]</span></p>
<p>#10.13</p>
</div>
<div id="section-2" class="section level2">
<h2>5.1</h2>
<p>考虑是<span class="math inline">\(g(x)=\frac{\pi}{3}sinx\)</span>对于<span class="math inline">\([0,\frac{\pi}{3}]\)</span>上的均匀分布的期望</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>m&lt;-<span class="st"> </span><span class="fl">1e5</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>x&lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span> pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>M&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">print</span>(<span class="kw">c</span>(M,<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 0.500536 0.500000</code></pre>
<p>这说明蒙特卡洛估计和积分的精确值很接近。</p>
</div>
<div id="section-3" class="section level2">
<h2>5.6</h2>
<p>可以计算得到如下结果 <span class="math display">\[
\begin{align}
Cov(e^{U},e^{1-U})&amp;=E(e^U*e^{1-U})-E(e^U)*E(e^{1-U})\\
&amp;=E(e)-(E(e^U))^2\\
&amp;=e-(e-1)^2\\
&amp;=3e-e^2-1
\end{align}
\]</span> <span class="math display">\[
\begin{align}
Var(e^U+e^{1-U})&amp;=E[(e^U+e^{1-U})^2]-(E(e^U+e^{1-U}))^2\\
&amp;=E(e^{2U}+2e^U*e^{1-U}+e^{2(1-U)})-(2*E(e^U))^2\\
&amp;=e^2-1+2e-(2(e-1))^2\\
&amp;=10e-3e^2-5
\end{align}
\]</span> <span class="math display">\[
\begin{align}
Var(e^U)&amp;=E(e^{2u})-(E(e^U))^2\\
&amp;=2e-0.5e^2-1.5
\end{align}
\]</span> 则可以计算出理论上可以减少的方差比率为<span class="math inline">\(1-\frac{\frac{1}{4}Var(e^U+e^{1-U})}{Var(e^U)}=0.9838\)</span></p>
</div>
<div id="section-4" class="section level2">
<h2>5.7</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">2333</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>m1&lt;-<span class="st"> </span><span class="dv">2000000</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>m2&lt;-<span class="st"> </span><span class="dv">2000000</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>X&lt;-<span class="st"> </span><span class="kw">runif</span>(m1,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>Y&lt;-<span class="st"> </span><span class="kw">runif</span>(m2,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>X_<span class="dv">1</span>&lt;-<span class="kw">exp</span>(X)</span>
<span id="cb10-7"><a href="#cb10-7"></a>Y_<span class="dv">1</span>&lt;-<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(Y)<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>Y)</span>
<span id="cb10-8"><a href="#cb10-8"></a>M1&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(X))</span>
<span id="cb10-9"><a href="#cb10-9"></a>M2&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(Y)<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>Y))</span>
<span id="cb10-10"><a href="#cb10-10"></a>V1&lt;-<span class="st"> </span><span class="kw">var</span>(X_<span class="dv">1</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>V2&lt;-<span class="st"> </span><span class="kw">var</span>(Y_<span class="dv">1</span>)</span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="kw">cat</span>(<span class="st">&quot;这是简单蒙特卡洛方法的结果和方差:&quot;</span>,M1,V1)</span></code></pre></div>
<pre><code>## 这是简单蒙特卡洛方法的结果和方差: 1.718148 0.2420739</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">cat</span>(<span class="st">&quot;这是采用对偶变量的方法的结果和方差:&quot;</span>,M2,V2)</span></code></pre></div>
<pre><code>## 这是采用对偶变量的方法的结果和方差: 1.718252 0.003913245</code></pre>
<p>可以计算出模拟得到的消除方差比率为0.9838。这和理论值非常吻合</p>
</div>
<div id="section-5" class="section level2">
<h2>5.11</h2>
<p>假设<span class="math inline">\(\hat{\theta_1}\)</span>和<span class="math inline">\(\hat{\theta_2}\)</span>是<span class="math inline">\(\theta\)</span>的两个无偏估计，那么易知<span class="math inline">\(\hat{\theta_c}=\hat{\theta_1}+(1-c)\hat{\theta_2}\)</span>也是一个无偏估计量。那么他的方差可以计算得到 <span class="math display">\[
\begin{align}
Var(\hat{\theta_c})&amp;=Var(\hat{\theta_2})+c^2Var(\hat{\theta_1}-\hat{\theta_2})+2cCov(\hat{\theta_2},\hat{\theta_1}-\hat{\theta_2})
\end{align}
\]</span> 这是一个关于<span class="math inline">\(c\)</span>的二次函数，开口向上，所以选取<span class="math inline">\(c\)</span>取值为对称轴时取值最小。即 <span class="math display">\[
c^*=-\frac{Cov(\hat{\theta_2},\hat{\theta_1}-\hat{\theta_2})}{Var(\hat{\theta_1}-\hat{\theta_2})}
\]</span></p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>10.20</h1>
<div id="section-7" class="section level2">
<h2>5.13</h2>
<p>首先先画出<span class="math inline">\(g(x)\)</span>的图象</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>x&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">1.05</span>,<span class="dv">3</span>,.<span class="dv">01</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>g&lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb14-3"><a href="#cb14-3"></a>  ((x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span><span class="fl">0.5</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>}</span>
<span id="cb14-5"><a href="#cb14-5"></a>y&lt;-<span class="st"> </span><span class="kw">g</span>(x)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="kw">plot</span>(x,y,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>推测正态分布和参数是3的卡方分布是比较好的重要函数</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>zt&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>kf&lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">500000</span>,<span class="dv">3</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>fg_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="kw">g</span>(zt)<span class="op">/</span><span class="kw">dnorm</span>(zt)</span>
<span id="cb15-5"><a href="#cb15-5"></a>fg_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">g</span>(kf)<span class="op">/</span><span class="kw">dchisq</span>(kf,<span class="dv">3</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a>g1&lt;-<span class="st"> </span><span class="kw">mean</span>(fg_<span class="dv">1</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a>se1&lt;-<span class="st"> </span><span class="kw">sd</span>(fg_<span class="dv">1</span>)</span>
<span id="cb15-8"><a href="#cb15-8"></a>g2&lt;-<span class="st"> </span><span class="kw">mean</span>(fg_<span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>se2&lt;-<span class="st"> </span><span class="kw">sd</span>(fg_<span class="dv">2</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="kw">cat</span>(<span class="st">&quot;重要函数取正态分布的结果和标准差:&quot;</span> ,g1 ,se1)</span></code></pre></div>
<pre><code>## 重要函数取正态分布的结果和标准差: 0.4021338 1.136242</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">cat</span>(<span class="st">&quot;重要函数取卡方分布的结果和标准差:&quot;</span> ,g2 ,se2)</span></code></pre></div>
<pre><code>## 重要函数取卡方分布的结果和标准差: 0.4010007 0.4955383</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">print</span>(<span class="kw">integrate</span>(g,<span class="dv">1</span>,<span class="ot">Inf</span>)) <span class="co">#这是标准的结果</span></span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<p>综上，发现用卡方分布做重要函数是比较好的，结果准确且方差小。</p>
</div>
<div id="section-8" class="section level2">
<h2>5,15</h2>
<p>考虑密度函数为<span class="math inline">\(f(x)=\frac{5e^{-x}}{1-e^{-1}}\)</span>,那么考虑五个等概率的区间，分别对五个区间进行重要抽样相加就是估计值，方差是各部分的方差相加</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>g1&lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb21-2"><a href="#cb21-2"></a>  (<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>}</span>
<span id="cb21-4"><a href="#cb21-4"></a>result&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a>m&lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb21-7"><a href="#cb21-7"></a>  rn&lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>  q&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>(rn <span class="op">+</span><span class="st"> </span>i <span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>))</span>
<span id="cb21-9"><a href="#cb21-9"></a>  fg&lt;-<span class="st"> </span><span class="kw">g1</span>(q)<span class="op">/</span>((<span class="dv">5</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>q)))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb21-10"><a href="#cb21-10"></a>  result[i,<span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb21-11"><a href="#cb21-11"></a>  result[i,<span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb21-12"><a href="#cb21-12"></a>}</span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="kw">cat</span>(<span class="st">&quot;分层重要抽样的结果是:&quot;</span>,<span class="kw">sum</span>(result[,<span class="dv">1</span>])) </span></code></pre></div>
<pre><code>## 分层重要抽样的结果是: 0.5243908</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">cat</span>(<span class="st">&quot;分层重要抽样的方差是:&quot;</span>,<span class="kw">sum</span>(result[,<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## 分层重要抽样的方差是: 8.787938e-05</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">print</span>(<span class="kw">integrate</span>(g1,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="co">#求一个积分的标准值</span></span></code></pre></div>
<pre><code>## 0.5247971 with absolute error &lt; 5.8e-15</code></pre>
<p>通过比较发现，分层重要抽样无论是结果还是方差都要更优。</p>
</div>
<div id="section-9" class="section level2">
<h2>6.4</h2>
<p>先从参数为0；1的对数正态分布中抽样，再计算<span class="math inline">\(\mu\)</span>理论上95%的置信区间,再计算这些区间包含 0的频率，和95%进行比较。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>w&lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>n&lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>alpha&lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>t&lt;-<span class="dv">0</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>s&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10000</span>,<span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</span>
<span id="cb27-7"><a href="#cb27-7"></a>  x&lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a>  s[i,<span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">+</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb27-9"><a href="#cb27-9"></a>  s[i,<span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span><span class="kw">sd</span>(<span class="kw">log</span>(x))<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb27-10"><a href="#cb27-10"></a>  <span class="cf">if</span>(s[i,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>s[i,<span class="dv">1</span>]<span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) t&lt;-t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>}</span>
<span id="cb27-12"><a href="#cb27-12"></a>t<span class="op">/</span><span class="dv">10000</span></span></code></pre></div>
<pre><code>## [1] 0.9588</code></pre>
<p>发现构造的置信区间的置信系数比较吻合理论。</p>
</div>
<div id="section-10" class="section level2">
<h2>6.5</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>w1&lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>n1&lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>alpha&lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>t&lt;-<span class="dv">0</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>s&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10000</span>,<span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</span>
<span id="cb29-7"><a href="#cb29-7"></a>  x&lt;-<span class="st"> </span><span class="kw">rchisq</span>(n1,<span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a>  s[i,<span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb29-9"><a href="#cb29-9"></a>  s[i,<span class="dv">2</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n<span class="dv">-1</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="cf">if</span>(s[i,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>s[i,<span class="dv">1</span>]<span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) t&lt;-t<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>}</span>
<span id="cb29-12"><a href="#cb29-12"></a>t<span class="op">/</span><span class="dv">10000</span></span></code></pre></div>
<pre><code>## [1] 0.9225</code></pre>
<p>发现相比样本来自正态分布的置信系数低一些，但是相比书上方差区间的0.773，没有方差那么敏感，更稳定一些。</p>
</div>
</div>
<div id="section-11" class="section level1">
<h1>10.27</h1>
<div id="section-12" class="section level2">
<h2>6.7</h2>
<p>首先我么定义求样本偏度的函数</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>sk&lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb31-2"><a href="#cb31-2"></a>  xbar&lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb31-3"><a href="#cb31-3"></a>  m3&lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>  m2&lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb31-6"><a href="#cb31-6"></a>}</span></code></pre></div>
<p>下面循环MC模拟求不同参数下的分布的<span class="math inline">\(\alpha1=\alpha2=\alpha\)</span>的beta分布的犯第一类错误，置信水平此时固定为0.05</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>a&lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>n&lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>m&lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>alpha&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>,<span class="fl">0.2</span>))</span>
<span id="cb32-5"><a href="#cb32-5"></a>N&lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb32-6"><a href="#cb32-6"></a>sd&lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>)))</span>
<span id="cb32-7"><a href="#cb32-7"></a>cv&lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,sd)</span>
<span id="cb32-8"><a href="#cb32-8"></a>pwrbeta&lt;-<span class="st"> </span><span class="kw">numeric</span>(N)<span class="co">#储存不同参数的功效值</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb32-10"><a href="#cb32-10"></a>  al&lt;-<span class="st"> </span>alpha[i]</span>
<span id="cb32-11"><a href="#cb32-11"></a>  sktests&lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb32-13"><a href="#cb32-13"></a>    x&lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,al,al)</span>
<span id="cb32-14"><a href="#cb32-14"></a>    sktests[j]&lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb32-15"><a href="#cb32-15"></a>  }</span>
<span id="cb32-16"><a href="#cb32-16"></a>  pwrbeta[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb32-17"><a href="#cb32-17"></a>}</span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="kw">plot</span>(alpha,pwrbeta,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.06</span>))</span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>现在对对称的t分布进行模拟</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>v&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>M&lt;-<span class="st"> </span><span class="kw">length</span>(v)</span>
<span id="cb33-3"><a href="#cb33-3"></a>pwrt&lt;-<span class="st"> </span><span class="kw">numeric</span>(M)</span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</span>
<span id="cb33-5"><a href="#cb33-5"></a>  vi&lt;-<span class="st"> </span>v[i]</span>
<span id="cb33-6"><a href="#cb33-6"></a>  sktests&lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb33-8"><a href="#cb33-8"></a>    x&lt;-<span class="st"> </span><span class="kw">rt</span>(n,vi)</span>
<span id="cb33-9"><a href="#cb33-9"></a>    sktests[j]&lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb33-10"><a href="#cb33-10"></a>  }</span>
<span id="cb33-11"><a href="#cb33-11"></a>  pwrt[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb33-12"><a href="#cb33-12"></a>}</span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="kw">plot</span>(v,pwrt,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以发现对于beta分布，参数越大，检验反第一类错误的可能性是越大的,可以画出不同参数的beta图象，其中红色的是正态分布作为对比，这是因为参数越大，越接近一个正态分布。所以由正态分布推出的检验的会在在参数越大时越接近置信系数。</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">curve</span>(<span class="kw">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">curve</span>(<span class="kw">dbeta</span>(x, <span class="dv">4</span>, <span class="dv">4</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">curve</span>(<span class="kw">dbeta</span>(x, <span class="dv">16</span>, <span class="dv">16</span>), <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x,<span class="fl">0.5</span>,<span class="fl">0.1</span>),<span class="dt">from =</span><span class="dv">0</span>,<span class="dt">to =</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>同样的画出不同参数t分布的密度函数图象,其中红色是正态分布作为对比</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">curve</span>(<span class="kw">dt</span>(x,<span class="dv">1</span>),<span class="dt">from =</span> <span class="dv">-4</span>,<span class="dt">to =</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">curve</span>(<span class="kw">dt</span>(x,<span class="dv">2</span>),<span class="dt">from =</span> <span class="dv">-4</span>,<span class="dt">to =</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">curve</span>(<span class="kw">dt</span>(x,<span class="dv">16</span>),<span class="dt">from =</span> <span class="dv">-4</span>,<span class="dt">to =</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">curve</span>(<span class="kw">dnorm</span>(x),<span class="dt">from =</span> <span class="dv">-4</span>,<span class="dt">to =</span><span class="dv">4</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>同样的，发现t分布在参数越大时越接近正态分布，所以同样的功效会接近置信系数。</p>
</div>
<div id="section-13" class="section level2">
<h2>6.8</h2>
<p>先定义count5检验的函数，输出值1代表认为拒绝等方差，0则相反。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>count5test&lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb42-2"><a href="#cb42-2"></a>  X&lt;-<span class="st"> </span>x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb42-3"><a href="#cb42-3"></a>  Y&lt;-<span class="st"> </span>y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb42-4"><a href="#cb42-4"></a>  outx&lt;-<span class="st"> </span><span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb42-5"><a href="#cb42-5"></a>  outy&lt;-<span class="st"> </span><span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outy,outx))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb42-7"><a href="#cb42-7"></a>}</span></code></pre></div>
<p>由数理统计知识，我们指导F检验对于两个正态分布进行等方差检验是一个很好的方法，下面定义F检验函数</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>Ftest&lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb43-2"><a href="#cb43-2"></a>  xl&lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb43-3"><a href="#cb43-3"></a>  yl&lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb43-4"><a href="#cb43-4"></a>  sx&lt;-<span class="st"> </span><span class="kw">var</span>(x)</span>
<span id="cb43-5"><a href="#cb43-5"></a>  sy&lt;-<span class="st"> </span><span class="kw">var</span>(y)</span>
<span id="cb43-6"><a href="#cb43-6"></a>  T&lt;-<span class="st"> </span>sy<span class="op">/</span>sx</span>
<span id="cb43-7"><a href="#cb43-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(T<span class="op">&lt;</span><span class="kw">qf</span>(<span class="fl">0.055</span><span class="op">/</span><span class="dv">2</span>,xl<span class="dv">-1</span>,yl<span class="dv">-2</span>)<span class="op">|</span>T<span class="op">&gt;</span><span class="kw">qf</span>(<span class="dv">1</span><span class="fl">-0.055</span><span class="op">/</span><span class="dv">2</span>,xl<span class="dv">-1</span>,yl<span class="dv">-1</span>)))</span>
<span id="cb43-8"><a href="#cb43-8"></a>}</span></code></pre></div>
<p>那么接下来对不同大小样本分布进行count5和F检验。</p>
<div id="小样本" class="section level3">
<h3>小样本</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>n1&lt;-<span class="dv">10</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>rnum&lt;-<span class="dv">2000</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>sig1&lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>sig2&lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>minpowercount5&lt;-<span class="kw">mean</span>(</span>
<span id="cb44-6"><a href="#cb44-6"></a>  <span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb44-7"><a href="#cb44-7"></a>    x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sig1)</span>
<span id="cb44-8"><a href="#cb44-8"></a>    y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sig2)</span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="kw">count5test</span>(x,y)</span>
<span id="cb44-10"><a href="#cb44-10"></a>  })</span>
<span id="cb44-11"><a href="#cb44-11"></a>)</span>
<span id="cb44-12"><a href="#cb44-12"></a>minpowerF&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb44-13"><a href="#cb44-13"></a>  x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sig1)</span>
<span id="cb44-14"><a href="#cb44-14"></a>  y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,<span class="dv">0</span>,sig1)</span>
<span id="cb44-15"><a href="#cb44-15"></a>  <span class="kw">Ftest</span>(x,y)</span>
<span id="cb44-16"><a href="#cb44-16"></a>})</span>
<span id="cb44-17"><a href="#cb44-17"></a>)</span>
<span id="cb44-18"><a href="#cb44-18"></a><span class="kw">cat</span>(<span class="st">&quot;这是小样本count5检验的功效&quot;</span>,minpowercount5)</span></code></pre></div>
<pre><code>## 这是小样本count5检验的功效 0.102</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">cat</span>(<span class="st">&quot;这是小样本F检验的功效&quot;</span>,minpowerF)</span></code></pre></div>
<pre><code>## 这是小样本F检验的功效 0.046</code></pre>
</div>
<div id="中样本" class="section level3">
<h3>中样本</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>rnum&lt;-<span class="dv">2000</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>sig1&lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>sig2&lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb48-5"><a href="#cb48-5"></a>midpowercount5&lt;-<span class="kw">mean</span>(</span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb48-7"><a href="#cb48-7"></a>    x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,sig1)</span>
<span id="cb48-8"><a href="#cb48-8"></a>    y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,sig2)</span>
<span id="cb48-9"><a href="#cb48-9"></a>    <span class="kw">count5test</span>(x,y)</span>
<span id="cb48-10"><a href="#cb48-10"></a>  })</span>
<span id="cb48-11"><a href="#cb48-11"></a>)</span>
<span id="cb48-12"><a href="#cb48-12"></a>midpowerF&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb48-13"><a href="#cb48-13"></a>  x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,sig1)</span>
<span id="cb48-14"><a href="#cb48-14"></a>  y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,<span class="dv">0</span>,sig2)</span>
<span id="cb48-15"><a href="#cb48-15"></a>  <span class="kw">Ftest</span>(x,y)</span>
<span id="cb48-16"><a href="#cb48-16"></a>})</span>
<span id="cb48-17"><a href="#cb48-17"></a>)</span>
<span id="cb48-18"><a href="#cb48-18"></a><span class="kw">cat</span>(<span class="st">&quot;这是中样本count5检验的功效&quot;</span>,midpowercount5)</span></code></pre></div>
<pre><code>## 这是中样本count5检验的功效 0.472</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">cat</span>(<span class="st">&quot;这是中样本F检验的功效&quot;</span>,midpowerF)</span></code></pre></div>
<pre><code>## 这是中样本F检验的功效 0.5835</code></pre>
</div>
<div id="大样本" class="section level3">
<h3>大样本</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>n3&lt;-<span class="dv">100</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>rnum&lt;-<span class="dv">200</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>sig1&lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>sig2&lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>maxpowercount5&lt;-<span class="kw">mean</span>(</span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb52-7"><a href="#cb52-7"></a>    x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3,<span class="dv">0</span>,sig1)</span>
<span id="cb52-8"><a href="#cb52-8"></a>    y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3,<span class="dv">0</span>,sig2)</span>
<span id="cb52-9"><a href="#cb52-9"></a>    <span class="kw">count5test</span>(x,y)</span>
<span id="cb52-10"><a href="#cb52-10"></a>  })</span>
<span id="cb52-11"><a href="#cb52-11"></a>)</span>
<span id="cb52-12"><a href="#cb52-12"></a>maxpowerF&lt;-<span class="kw">mean</span>(<span class="kw">replicate</span>(rnum,<span class="dt">expr =</span> {</span>
<span id="cb52-13"><a href="#cb52-13"></a>  x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3,<span class="dv">0</span>,sig1)</span>
<span id="cb52-14"><a href="#cb52-14"></a>  y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n3,<span class="dv">0</span>,sig2)</span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="kw">Ftest</span>(x,y)</span>
<span id="cb52-16"><a href="#cb52-16"></a>})</span>
<span id="cb52-17"><a href="#cb52-17"></a>)</span>
<span id="cb52-18"><a href="#cb52-18"></a><span class="kw">cat</span>(<span class="st">&quot;这是中样本count5检验的功效&quot;</span>,maxpowercount5)</span></code></pre></div>
<pre><code>## 这是中样本count5检验的功效 0.84</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">cat</span>(<span class="st">&quot;这是中样本F检验的功效&quot;</span>,maxpowerF)</span></code></pre></div>
<pre><code>## 这是中样本F检验的功效 0.975</code></pre>
<p>这说明F检验的功效函数样本数量越大功效增长越快。</p>
</div>
</div>
<div id="c" class="section level2">
<h2>6.C</h2>
<p>因为多元偏度统计量为 <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{\mathrm{T}} \widehat{\Sigma}^{-1}\left(\left(X_{j}-\bar{X}\right)\right)^{3}\right.
\]</span> 且指导它在正态假设下会满足自由度为<span class="math inline">\(t=\frac{1}{6}d(d+1)(d+2)\)</span>的卡方分布。所以对于大小为n=10，30，50，100，500的样本，计算出临界值为<span class="math inline">\((\frac{6}{n}X_t^2(0.975),\frac{6}{n}X_t^2(0.025))\)</span>,即当多元偏度值超过这个范围，即拒绝偏度为零的假设。下面计算</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>n=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a>cv&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>cv[,<span class="dv">2</span>]&lt;-<span class="st"> </span>(<span class="dv">6</span><span class="op">/</span>n)<span class="op">*</span><span class="kw">qchisq</span>(<span class="fl">0.975</span>,<span class="dv">4</span>)</span>
<span id="cb56-4"><a href="#cb56-4"></a>cv[,<span class="dv">1</span>]&lt;-<span class="st"> </span>(<span class="dv">6</span><span class="op">/</span>n)<span class="op">*</span><span class="kw">qchisq</span>(<span class="fl">0.025</span>,<span class="dv">4</span>)</span>
<span id="cb56-5"><a href="#cb56-5"></a>cv&lt;-<span class="kw">data.frame</span>(cv,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>))</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="kw">colnames</span>(cv)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;l&quot;</span>,<span class="st">&quot;r&quot;</span>)</span>
<span id="cb56-7"><a href="#cb56-7"></a>cv</span></code></pre></div>
<pre><code>##              l         r
## 10  0.29065113 6.6859721
## 20  0.14532557 3.3429860
## 30  0.09688371 2.2286574
## 50  0.05813023 1.3371944
## 100 0.02906511 0.6685972</code></pre>
<p>下面定义计算多维样本偏度统计量的计算函数</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb58-2"><a href="#cb58-2"></a>msk&lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="co">#x是一个n*d的矩阵，代表n个d维样本</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>  n=<span class="kw">nrow</span>(x)</span>
<span id="cb58-4"><a href="#cb58-4"></a>  mlsig&lt;-<span class="st"> </span><span class="kw">cov</span>(x)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n</span>
<span id="cb58-5"><a href="#cb58-5"></a>  cmlsig&lt;-<span class="st"> </span><span class="kw">solve</span>(mlsig)</span>
<span id="cb58-6"><a href="#cb58-6"></a>  xbar&lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb58-7"><a href="#cb58-7"></a>  n2bd&lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb58-8"><a href="#cb58-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb58-9"><a href="#cb58-9"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb58-10"><a href="#cb58-10"></a>      n2bd&lt;-n2bd<span class="op">+</span>(<span class="kw">t</span>(x[i,]<span class="op">-</span>xbar)<span class="op">%*%</span>cmlsig<span class="op">%*%</span>(x[j,]<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb58-11"><a href="#cb58-11"></a>    } </span>
<span id="cb58-12"><a href="#cb58-12"></a>  }</span>
<span id="cb58-13"><a href="#cb58-13"></a>  <span class="kw">return</span>(n2bd<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb58-14"><a href="#cb58-14"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a>pM&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb59-5"><a href="#cb59-5"></a>  msktests&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">1000</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</span>
<span id="cb59-7"><a href="#cb59-7"></a>    x&lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</span>
<span id="cb59-8"><a href="#cb59-8"></a>    v&lt;-<span class="st"> </span><span class="kw">msk</span>(x)</span>
<span id="cb59-9"><a href="#cb59-9"></a>    <span class="cf">if</span>(v<span class="op">&lt;</span>cv[i,<span class="dv">1</span>]<span class="op">|</span>v<span class="op">&gt;</span>cv[i,<span class="dv">2</span>])</span>
<span id="cb59-10"><a href="#cb59-10"></a>      msktests[j]&lt;-<span class="dv">1</span> <span class="cf">else</span></span>
<span id="cb59-11"><a href="#cb59-11"></a>        msktests[j]&lt;-<span class="dv">0</span></span>
<span id="cb59-12"><a href="#cb59-12"></a>  }</span>
<span id="cb59-13"><a href="#cb59-13"></a>  pM[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(msktests)</span>
<span id="cb59-14"><a href="#cb59-14"></a>}</span>
<span id="cb59-15"><a href="#cb59-15"></a><span class="kw">cat</span>(<span class="st">&quot;这是对应的模拟置信系数&quot;</span>,pM)</span></code></pre></div>
<pre><code>## 这是对应的模拟置信系数 0.071 0.059 0.053 0.057 0.045</code></pre>
<p>下面对污染的多元正态分布的参数，计算多元偏度卡方检验的功效。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>m&lt;-<span class="dv">200</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb61-4"><a href="#cb61-4"></a>epsilon&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb61-5"><a href="#cb61-5"></a>el&lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb61-6"><a href="#cb61-6"></a>mskpwr&lt;-<span class="dv">1</span><span class="op">:</span>el</span>
<span id="cb61-7"><a href="#cb61-7"></a>cv&lt;-<span class="kw">c</span>((<span class="dv">6</span><span class="op">/</span>n)<span class="op">*</span><span class="kw">qchisq</span>(<span class="fl">0.05</span>,<span class="dv">4</span>),(<span class="dv">6</span><span class="op">/</span>n)<span class="op">*</span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">4</span>))</span>
<span id="cb61-8"><a href="#cb61-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>el) {</span>
<span id="cb61-9"><a href="#cb61-9"></a>  e&lt;-epsilon[i]</span>
<span id="cb61-10"><a href="#cb61-10"></a>  mskt&lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb61-11"><a href="#cb61-11"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb61-12"><a href="#cb61-12"></a>    k&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n,<span class="dt">prob =</span> <span class="kw">c</span>(e,<span class="dv">1</span><span class="op">-</span>e))</span>
<span id="cb61-13"><a href="#cb61-13"></a>    z&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">2</span>)</span>
<span id="cb61-14"><a href="#cb61-14"></a>    x&lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), Sigma)</span>
<span id="cb61-15"><a href="#cb61-15"></a>    y&lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dv">4</span><span class="op">*</span>Sigma)</span>
<span id="cb61-16"><a href="#cb61-16"></a>    <span class="cf">for</span> (h <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) {</span>
<span id="cb61-17"><a href="#cb61-17"></a>      <span class="cf">if</span>(k[h]<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb61-18"><a href="#cb61-18"></a>        z[h,]&lt;-x[h,]<span class="cf">else</span></span>
<span id="cb61-19"><a href="#cb61-19"></a>          z[h,]&lt;-y[h,]</span>
<span id="cb61-20"><a href="#cb61-20"></a>    }</span>
<span id="cb61-21"><a href="#cb61-21"></a>    v&lt;-<span class="st"> </span><span class="kw">msk</span>(z)</span>
<span id="cb61-22"><a href="#cb61-22"></a>    <span class="cf">if</span>(v<span class="op">&lt;</span>cv[<span class="dv">1</span>]<span class="op">|</span>v<span class="op">&gt;</span>cv[<span class="dv">2</span>])</span>
<span id="cb61-23"><a href="#cb61-23"></a>      mskt[j]&lt;-<span class="dv">1</span> <span class="cf">else</span></span>
<span id="cb61-24"><a href="#cb61-24"></a>        mskt[j]&lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb61-25"><a href="#cb61-25"></a>  }</span>
<span id="cb61-26"><a href="#cb61-26"></a>  mskpwr[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(mskt)</span>
<span id="cb61-27"><a href="#cb61-27"></a>}</span>
<span id="cb61-28"><a href="#cb61-28"></a> <span class="kw">plot</span>(epsilon,mskpwr,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb61-29"><a href="#cb61-29"></a> <span class="kw">abline</span>(<span class="dt">h=</span> <span class="fl">0.1</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> 可以发现，在<span class="math inline">\(\epsilon\)</span>等于0或者1时，是很接近预先设定的0.1置信系数，这是因为在0或1时，是一个标准正态。</p>
</div>
<div id="disscusion" class="section level2">
<h2>Disscusion</h2>
<p><span class="math display">\[
\frac{\sum_{i=1}^{n}X_i-np}{\sqrt{n}(1-p)p}\rightarrow N(0,1)
\]</span> 因为这是大样本，所以将样本方差代替总体方差，分别对两组数据进行中心化近似，化简可以得到 <span class="math display">\[
p1-p2 \~{} N(\sum(X_i-Y_i),\frac{S_x^2+S_y^2}{n})
\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co">#所以进行检验，发现其0.95的置信区间为</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>S&lt;-<span class="st"> </span>(<span class="fl">0.651</span><span class="op">*</span>(<span class="dv">1</span><span class="fl">-0.651</span>)<span class="op">+</span>(<span class="dv">1</span><span class="fl">-0.676</span>)<span class="op">*</span><span class="fl">0.676</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="kw">cat</span>(<span class="kw">qnorm</span>(<span class="fl">0.025</span>,<span class="fl">0.025</span>,S),<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="fl">0.025</span>,S))</span></code></pre></div>
<pre><code>## 0.02491254 0.02508746</code></pre>
<p>发现0不在里面，在0.05的水平上可以拒绝功效相同的原假设。</p>
<p>1.H0就是两种检验功效相等</p>
<p>2.大样本利用中心极限定理进行正太化近似，然后进行两正态分布的均值检验</p>
<p>3.因为MC检验法实际上已经在此功效下的二项分布抽样，所以题目已知数据已经足够。</p>
</div>
</div>
<div id="section-14" class="section level1">
<h1>11.3</h1>
<div id="section-15" class="section level2">
<h2>7.1</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb64-3"><a href="#cb64-3"></a>corhat&lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT,law<span class="op">$</span>GPA)</span>
<span id="cb64-4"><a href="#cb64-4"></a>n&lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb64-5"><a href="#cb64-5"></a>corjack&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n </span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb64-7"><a href="#cb64-7"></a>  LAST&lt;-<span class="st"> </span>law<span class="op">$</span>LSAT[<span class="op">-</span>i]</span>
<span id="cb64-8"><a href="#cb64-8"></a>  GPA&lt;-<span class="st"> </span>law<span class="op">$</span>GPA[<span class="op">-</span>i]</span>
<span id="cb64-9"><a href="#cb64-9"></a>  corjack[i]&lt;-<span class="st"> </span><span class="kw">cor</span>(LAST,GPA)</span>
<span id="cb64-10"><a href="#cb64-10"></a>}</span>
<span id="cb64-11"><a href="#cb64-11"></a>corbias&lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(corjack)<span class="op">-</span>corhat)</span>
<span id="cb64-12"><a href="#cb64-12"></a>se&lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((corjack<span class="op">-</span><span class="kw">mean</span>(corjack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="kw">cat</span>(<span class="st">&quot;This is jacknife&#39;s bias and standard error:&quot;</span>,corbias,se)</span></code></pre></div>
<pre><code>## This is jacknife&#39;s bias and standard error: -0.006473623 0.1425186</code></pre>
</div>
<div id="section-16" class="section level2">
<h2>7.5</h2>
<p>we can easily to obtain the MLE of <span class="math inline">\(\lambda\)</span> <span class="math display">\[
\begin{aligned}
&amp;\because f(x_1,x_2,...,x_n)=\lambda^ne^{-\lambda\sum_{i=1}^nx_i}\\
&amp;\therefore lnf=nln\lambda-\lambda\sum_{i=1}^n x_i\\
&amp; \therefore \frac{\partial lnf}{\partial \lambda}= \frac{n}{\lambda}-\sum_{i=1}^nx_i\\
&amp;\therefore \lambda_{MLE}=\frac{n}{\sum_{i=1}^nx_i}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</span>
<span id="cb66-2"><a href="#cb66-2"></a>  t&lt;-<span class="st"> </span>x[i]</span>
<span id="cb66-3"><a href="#cb66-3"></a>  <span class="dv">12</span><span class="op">/</span><span class="kw">sum</span>(t)</span>
<span id="cb66-4"><a href="#cb66-4"></a>}</span>
<span id="cb66-5"><a href="#cb66-5"></a>air&lt;-<span class="st"> </span><span class="kw">as.vector</span>(aircondit<span class="op">$</span>hours)</span>
<span id="cb66-6"><a href="#cb66-6"></a>obj&lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> air,<span class="dt">statistic =</span> f,<span class="dt">R=</span> <span class="dv">2000</span>)</span>
<span id="cb66-7"><a href="#cb66-7"></a>obj</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = air, statistic = f, R = 2000)
## 
## 
## Bootstrap Statistics :
##       original     bias    std. error
## t1* 0.00925212 0.00128106  0.00420192</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (-0.0003,  0.0162 )   (-0.0025,  0.0132 )  
## 
## Level     Percentile            BCa          
## 95%   ( 0.0053,  0.0210 )   ( 0.0046,  0.0177 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>we can see the normal intervals is quite different with others,because the data is not come from a norm distribution.the basic way is not very accurate because wo do not know the distribution of <span class="math inline">\(\lambda\)</span>’s estimation.and the per and bca way is more accurate than the others,because they are the quantities of bootstrap results,and bca has bias modification and adjusted for acceleration.</p>
</div>
<div id="section-17" class="section level2">
<h2>7.8</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>scorm&lt;-<span class="st"> </span><span class="kw">as.matrix</span>(scor)</span>
<span id="cb70-2"><a href="#cb70-2"></a>M&lt;-<span class="kw">cov</span>(scorm)</span>
<span id="cb70-3"><a href="#cb70-3"></a>t&lt;-<span class="st"> </span><span class="kw">eigen</span>(M)<span class="op">$</span>val</span>
<span id="cb70-4"><a href="#cb70-4"></a>val&lt;-<span class="st"> </span>t[<span class="kw">order</span>(t,<span class="dt">decreasing =</span> <span class="ot">TRUE</span>)]</span>
<span id="cb70-5"><a href="#cb70-5"></a>thetahat&lt;-val[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(val)</span>
<span id="cb70-6"><a href="#cb70-6"></a>n&lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb70-7"><a href="#cb70-7"></a>thetajack&lt;-<span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb70-8"><a href="#cb70-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb70-9"><a href="#cb70-9"></a>  newscor&lt;-<span class="st"> </span>scorm[<span class="op">-</span>i,]</span>
<span id="cb70-10"><a href="#cb70-10"></a>  M&lt;-<span class="kw">cov</span>(newscor)</span>
<span id="cb70-11"><a href="#cb70-11"></a>  t&lt;-<span class="st"> </span><span class="kw">eigen</span>(M)<span class="op">$</span>val</span>
<span id="cb70-12"><a href="#cb70-12"></a>  val&lt;-<span class="st"> </span>t[<span class="kw">order</span>(t,<span class="dt">decreasing =</span> <span class="ot">TRUE</span>)]</span>
<span id="cb70-13"><a href="#cb70-13"></a>  thetajack[i]&lt;-<span class="st"> </span>val[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(val)</span>
<span id="cb70-14"><a href="#cb70-14"></a>}</span>
<span id="cb70-15"><a href="#cb70-15"></a>bias&lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(thetajack)<span class="op">-</span>thetahat)</span>
<span id="cb70-16"><a href="#cb70-16"></a>se&lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((thetajack<span class="op">-</span><span class="kw">mean</span>(thetajack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb70-17"><a href="#cb70-17"></a><span class="kw">cat</span>(<span class="st">&quot;this is bias and se:&quot;</span>,bias,se)</span></code></pre></div>
<pre><code>## this is bias and se: 0.001069139 0.04955231</code></pre>
</div>
<div id="section-18" class="section level2">
<h2>7.11</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>magnetic&lt;-<span class="st"> </span>ironslag[,<span class="dv">2</span>]</span>
<span id="cb78-2"><a href="#cb78-2"></a>chemical&lt;-<span class="st"> </span>ironslag[,<span class="dv">1</span>]</span>
<span id="cb78-3"><a href="#cb78-3"></a>n&lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</span>
<span id="cb78-4"><a href="#cb78-4"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</span>
<span id="cb78-5"><a href="#cb78-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) {</span>
<span id="cb78-6"><a href="#cb78-6"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>){</span>
<span id="cb78-7"><a href="#cb78-7"></a>    y&lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb78-8"><a href="#cb78-8"></a>    x&lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]</span>
<span id="cb78-9"><a href="#cb78-9"></a>    </span>
<span id="cb78-10"><a href="#cb78-10"></a>    J1&lt;-<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb78-11"><a href="#cb78-11"></a>    yhat1i&lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i]</span>
<span id="cb78-12"><a href="#cb78-12"></a>    yhat1j&lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j]</span>
<span id="cb78-13"><a href="#cb78-13"></a>    e1[i,j]&lt;-<span class="st"> </span>((magnetic[i]<span class="op">-</span>yhat1i)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat1j)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb78-14"><a href="#cb78-14"></a>    </span>
<span id="cb78-15"><a href="#cb78-15"></a>    J2&lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb78-16"><a href="#cb78-16"></a>    yhat2i&lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[i]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>    yhat2j&lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[j]<span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb78-18"><a href="#cb78-18"></a>    e2[i,j]&lt;-<span class="st"> </span>((magnetic[i]<span class="op">-</span>yhat2i)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat2j)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb78-19"><a href="#cb78-19"></a></span>
<span id="cb78-20"><a href="#cb78-20"></a>    J3&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb78-21"><a href="#cb78-21"></a>    logyhat3i&lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[i]</span>
<span id="cb78-22"><a href="#cb78-22"></a>    logyhat3j&lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[j]</span>
<span id="cb78-23"><a href="#cb78-23"></a>    yhat3i&lt;-<span class="kw">exp</span>(logyhat3i)</span>
<span id="cb78-24"><a href="#cb78-24"></a>    yhat3j&lt;-<span class="kw">exp</span>(logyhat3j)</span>
<span id="cb78-25"><a href="#cb78-25"></a>    e3[i,j]&lt;-<span class="st"> </span>((magnetic[i]<span class="op">-</span>yhat3i)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat3j)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb78-26"><a href="#cb78-26"></a></span>
<span id="cb78-27"><a href="#cb78-27"></a>    J4&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb78-28"><a href="#cb78-28"></a>    logyhat4i&lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(chemical[i])</span>
<span id="cb78-29"><a href="#cb78-29"></a>    logyhat4j&lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(chemical[j])</span>
<span id="cb78-30"><a href="#cb78-30"></a>    yhat4i&lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4i)</span>
<span id="cb78-31"><a href="#cb78-31"></a>    yhat4j&lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4j)</span>
<span id="cb78-32"><a href="#cb78-32"></a>    e4[i,j]&lt;-<span class="st"> </span>((magnetic[i]<span class="op">-</span>yhat4i)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>yhat4j)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb78-33"><a href="#cb78-33"></a>  }</span>
<span id="cb78-34"><a href="#cb78-34"></a>}</span>
<span id="cb78-35"><a href="#cb78-35"></a><span class="kw">cat</span>(<span class="st">&quot;these are four modoel&#39;s estimate error:&quot;</span>,<span class="kw">sum</span>(e1)<span class="op">/</span><span class="dv">1378</span>,<span class="kw">sum</span>(e2)<span class="op">/</span><span class="dv">1378</span>,<span class="kw">sum</span>(e3)<span class="op">/</span><span class="dv">1378</span>,</span>
<span id="cb78-36"><a href="#cb78-36"></a>    <span class="kw">sum</span>(e4)<span class="op">/</span><span class="dv">1378</span>)</span></code></pre></div>
<pre><code>## these are four modoel&#39;s estimate error: 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>so the result is the same as “leave one out”, the second model is more suitable.</p>
</div>
</div>
<div id="section-19" class="section level1">
<h1>11.10</h1>
<div id="section-20" class="section level2">
<h2>8.3</h2>
<p>利用不放回抽样，然后置换抽样，抽取比较适合count5检验的样本大小。</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>count5test&lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb80-2"><a href="#cb80-2"></a>  X&lt;-<span class="st"> </span>x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb80-3"><a href="#cb80-3"></a>  Y&lt;-<span class="st"> </span>y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb80-4"><a href="#cb80-4"></a>  outx&lt;-<span class="st"> </span><span class="kw">sum</span>(X<span class="op">&gt;</span><span class="kw">max</span>(Y))<span class="op">+</span><span class="kw">sum</span>(X<span class="op">&lt;</span><span class="kw">min</span>(Y))</span>
<span id="cb80-5"><a href="#cb80-5"></a>  outy&lt;-<span class="st"> </span><span class="kw">sum</span>(Y<span class="op">&gt;</span><span class="kw">max</span>(X))<span class="op">+</span><span class="kw">sum</span>(Y<span class="op">&lt;</span><span class="kw">min</span>(X))</span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outy,outx))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb80-7"><a href="#cb80-7"></a>}</span>
<span id="cb80-8"><a href="#cb80-8"></a>x&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb80-9"><a href="#cb80-9"></a>y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb80-10"><a href="#cb80-10"></a>count5&lt;-<span class="st"> </span><span class="cf">function</span>(x,y,B){</span>
<span id="cb80-11"><a href="#cb80-11"></a>  I&lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</span>
<span id="cb80-12"><a href="#cb80-12"></a>  xl&lt;-<span class="kw">length</span>(x)</span>
<span id="cb80-13"><a href="#cb80-13"></a>  yl&lt;-<span class="kw">length</span>(y)</span>
<span id="cb80-14"><a href="#cb80-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</span>
<span id="cb80-15"><a href="#cb80-15"></a>    xi&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>xl,<span class="dv">20</span>,<span class="dt">replace =</span> F)</span>
<span id="cb80-16"><a href="#cb80-16"></a>    yi&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>yl,<span class="dv">20</span>,<span class="dt">replace =</span> F)</span>
<span id="cb80-17"><a href="#cb80-17"></a>    newx&lt;-<span class="st"> </span>x[xi]</span>
<span id="cb80-18"><a href="#cb80-18"></a>    newy&lt;-<span class="st"> </span>y[yi]</span>
<span id="cb80-19"><a href="#cb80-19"></a>    I[i]&lt;-<span class="st"> </span><span class="kw">count5test</span>(newx,newy)</span>
<span id="cb80-20"><a href="#cb80-20"></a>  }</span>
<span id="cb80-21"><a href="#cb80-21"></a>  <span class="kw">return</span>((<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(I))<span class="op">/</span>(B<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb80-22"><a href="#cb80-22"></a>}</span>
<span id="cb80-23"><a href="#cb80-23"></a><span class="kw">count5</span>(x,y,<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 0.01298701</code></pre>
</div>
<div id="discussion" class="section level2">
<h2>discussion</h2>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="kw">library</span>(Ball)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">library</span>(energy)</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="kw">library</span>(RANN)</span>
<span id="cb82-5"><a href="#cb82-5"></a>m&lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>k&lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>p&lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb82-8"><a href="#cb82-8"></a>mu&lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="kw">set.seed</span>(<span class="dv">233</span>)</span>
<span id="cb82-10"><a href="#cb82-10"></a>n1&lt;-n2&lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb82-11"><a href="#cb82-11"></a>R&lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb82-12"><a href="#cb82-12"></a>n&lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb82-13"><a href="#cb82-13"></a>N&lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb82-14"><a href="#cb82-14"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb82-15"><a href="#cb82-15"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb82-16"><a href="#cb82-16"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb82-17"><a href="#cb82-17"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb82-18"><a href="#cb82-18"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb82-19"><a href="#cb82-19"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb82-20"><a href="#cb82-20"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb82-21"><a href="#cb82-21"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb82-22"><a href="#cb82-22"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb82-23"><a href="#cb82-23"></a>}</span>
<span id="cb82-24"><a href="#cb82-24"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb82-25"><a href="#cb82-25"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb82-26"><a href="#cb82-26"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb82-27"><a href="#cb82-27"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb82-28"><a href="#cb82-28"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb82-29"><a href="#cb82-29"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb82-30"><a href="#cb82-30"></a>}</span>
<span id="cb82-31"><a href="#cb82-31"></a>p1.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb82-32"><a href="#cb82-32"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb82-33"><a href="#cb82-33"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb82-34"><a href="#cb82-34"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="fl">0.3</span>));</span>
<span id="cb82-35"><a href="#cb82-35"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb82-36"><a href="#cb82-36"></a>  p1.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb82-37"><a href="#cb82-37"></a>  p1.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb82-38"><a href="#cb82-38"></a>  p1.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb82-39"><a href="#cb82-39"></a>}</span>
<span id="cb82-40"><a href="#cb82-40"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb82-41"><a href="#cb82-41"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p1.values<span class="op">&lt;</span>alpha)</span>
<span id="cb82-42"><a href="#cb82-42"></a>pow1<span class="co">#上课的示例</span></span></code></pre></div>
<pre><code>## [1] 0.45 0.76 0.96</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>p2.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb84-3"><a href="#cb84-3"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.6</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-4"><a href="#cb84-4"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb84-5"><a href="#cb84-5"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb84-6"><a href="#cb84-6"></a>  p2.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb84-7"><a href="#cb84-7"></a>  p2.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb84-8"><a href="#cb84-8"></a>  p2.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb84-9"><a href="#cb84-9"></a>}</span>
<span id="cb84-10"><a href="#cb84-10"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb84-11"><a href="#cb84-11"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p2.values<span class="op">&lt;</span>alpha)</span>
<span id="cb84-12"><a href="#cb84-12"></a>pow2<span class="co">#等均值不等方差</span></span></code></pre></div>
<pre><code>## [1] 0.58 0.77 0.96</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>p3.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb86-3"><a href="#cb86-3"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="fl">0.3</span>,<span class="fl">1.4</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb86-4"><a href="#cb86-4"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb86-5"><a href="#cb86-5"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb86-6"><a href="#cb86-6"></a>  p3.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb86-7"><a href="#cb86-7"></a>  p3.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb86-8"><a href="#cb86-8"></a>  p3.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb86-9"><a href="#cb86-9"></a>}</span>
<span id="cb86-10"><a href="#cb86-10"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb86-11"><a href="#cb86-11"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p3.values<span class="op">&lt;</span>alpha)</span>
<span id="cb86-12"><a href="#cb86-12"></a>pow3<span class="co">#不等均值不等方差</span></span></code></pre></div>
<pre><code>## [1] 0.53 0.71 0.90</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>p4.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb88-3"><a href="#cb88-3"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>) ,<span class="dt">ncol=</span>p)</span>
<span id="cb88-4"><a href="#cb88-4"></a>  yy&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n2<span class="op">*</span>p</span>
<span id="cb88-5"><a href="#cb88-5"></a>  a&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,n2<span class="op">*</span>p)</span>
<span id="cb88-6"><a href="#cb88-6"></a>  a[<span class="dv">1</span>,]&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">-.1</span>,<span class="dv">2</span>)</span>
<span id="cb88-7"><a href="#cb88-7"></a>  a[<span class="dv">2</span>,]&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">.1</span>,<span class="dv">2</span>)</span>
<span id="cb88-8"><a href="#cb88-8"></a>  index&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),p<span class="op">*</span>n2,<span class="dt">replace =</span> T,<span class="dt">prob =</span> <span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb88-9"><a href="#cb88-9"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb88-10"><a href="#cb88-10"></a>    yy[j]&lt;-a[index[j],j]</span>
<span id="cb88-11"><a href="#cb88-11"></a>  }</span>
<span id="cb88-12"><a href="#cb88-12"></a>  y&lt;-<span class="kw">matrix</span>(yy,<span class="dt">ncol =</span> p)</span>
<span id="cb88-13"><a href="#cb88-13"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb88-14"><a href="#cb88-14"></a>  p4.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb88-15"><a href="#cb88-15"></a>  p4.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb88-16"><a href="#cb88-16"></a>  p4.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb88-17"><a href="#cb88-17"></a>}</span>
<span id="cb88-18"><a href="#cb88-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb88-19"><a href="#cb88-19"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p4.values<span class="op">&lt;</span>alpha)</span>
<span id="cb88-20"><a href="#cb88-20"></a>pow4<span class="co">#自由度为1的t分布</span></span></code></pre></div>
<pre><code>## [1] 0.55 0.61 0.53</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>p5.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb90-3"><a href="#cb90-3"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>) ,<span class="dt">ncol=</span>p)</span>
<span id="cb90-4"><a href="#cb90-4"></a>  yy&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n2<span class="op">*</span>p</span>
<span id="cb90-5"><a href="#cb90-5"></a>  a&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,n2<span class="op">*</span>p)</span>
<span id="cb90-6"><a href="#cb90-6"></a>  a[<span class="dv">1</span>,]&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">-0.01</span>,<span class="dv">2</span>)</span>
<span id="cb90-7"><a href="#cb90-7"></a>  a[<span class="dv">2</span>,]&lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">0.01</span>,<span class="dv">2</span>)</span>
<span id="cb90-8"><a href="#cb90-8"></a>  index&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),p<span class="op">*</span>n2,<span class="dt">replace =</span> T,<span class="dt">prob =</span> <span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb90-9"><a href="#cb90-9"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) {</span>
<span id="cb90-10"><a href="#cb90-10"></a>    yy[j]&lt;-a[index[j],j]</span>
<span id="cb90-11"><a href="#cb90-11"></a>  }</span>
<span id="cb90-12"><a href="#cb90-12"></a>  y&lt;-<span class="kw">matrix</span>(yy,<span class="dt">ncol =</span> p)</span>
<span id="cb90-13"><a href="#cb90-13"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb90-14"><a href="#cb90-14"></a>  p5.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb90-15"><a href="#cb90-15"></a>  p5.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb90-16"><a href="#cb90-16"></a>  p5.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb90-17"><a href="#cb90-17"></a>}</span>
<span id="cb90-18"><a href="#cb90-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb90-19"><a href="#cb90-19"></a>pow5 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p5.values<span class="op">&lt;</span>alpha)</span>
<span id="cb90-20"><a href="#cb90-20"></a>pow5 <span class="co">#自由度为1的t分布和双正态</span></span></code></pre></div>
<pre><code>## [1] 0.55 0.60 0.49</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>p6.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb92-3"><a href="#cb92-3"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb92-4"><a href="#cb92-4"></a>  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>),<span class="kw">rnorm</span>(<span class="dv">10</span>));</span>
<span id="cb92-5"><a href="#cb92-5"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb92-6"><a href="#cb92-6"></a>  p6.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb92-7"><a href="#cb92-7"></a>  p6.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">10</span>),<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb92-8"><a href="#cb92-8"></a>  p6.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb92-9"><a href="#cb92-9"></a>}</span>
<span id="cb92-10"><a href="#cb92-10"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb92-11"><a href="#cb92-11"></a>pow6 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p6.values<span class="op">&lt;</span>alpha)</span>
<span id="cb92-12"><a href="#cb92-12"></a>pow6<span class="co">#不平衡样本</span></span></code></pre></div>
<pre><code>## [1] 0.08 0.04 0.67</code></pre>
</div>
</div>
<div id="section-21" class="section level1">
<h1>11.17</h1>
<div id="section-22" class="section level2">
<h2>9.4</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>la.Me&lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x_<span class="dv">0</span>,N){</span>
<span id="cb94-2"><a href="#cb94-2"></a>  x&lt;-<span class="st"> </span><span class="kw">numeric</span>(N)<span class="co">#链</span></span>
<span id="cb94-3"><a href="#cb94-3"></a>  x[<span class="dv">1</span>]&lt;-<span class="st"> </span>x_<span class="dv">0</span></span>
<span id="cb94-4"><a href="#cb94-4"></a>  u&lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb94-5"><a href="#cb94-5"></a>  k&lt;-<span class="st"> </span><span class="dv">0</span><span class="co">#拒绝</span></span>
<span id="cb94-6"><a href="#cb94-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb94-7"><a href="#cb94-7"></a>    y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb94-8"><a href="#cb94-8"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb94-9"><a href="#cb94-9"></a>      x[i]&lt;-<span class="st"> </span>y <span class="cf">else</span>{</span>
<span id="cb94-10"><a href="#cb94-10"></a>        x[i]&lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb94-11"><a href="#cb94-11"></a>        k&lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb94-12"><a href="#cb94-12"></a>      }</span>
<span id="cb94-13"><a href="#cb94-13"></a>  }</span>
<span id="cb94-14"><a href="#cb94-14"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>N<span class="op">-</span>k))</span>
<span id="cb94-15"><a href="#cb94-15"></a>}</span>
<span id="cb94-16"><a href="#cb94-16"></a>la1&lt;-<span class="st"> </span><span class="kw">la.Me</span>(<span class="fl">0.05</span>,<span class="dv">2</span>,<span class="dv">2000</span>)</span>
<span id="cb94-17"><a href="#cb94-17"></a>la2&lt;-<span class="st"> </span><span class="kw">la.Me</span>(<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">2000</span>)</span>
<span id="cb94-18"><a href="#cb94-18"></a>la3&lt;-<span class="st"> </span><span class="kw">la.Me</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2000</span>)</span>
<span id="cb94-19"><a href="#cb94-19"></a>la4&lt;-<span class="st"> </span><span class="kw">la.Me</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2000</span>)</span>
<span id="cb94-20"><a href="#cb94-20"></a><span class="kw">plot</span>(la1<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">plot</span>(la2<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">plot</span>(la3<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">plot</span>(la4<span class="op">$</span>x,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="kw">print</span>(<span class="kw">c</span>(la1<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>,la2<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>,la3<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>,la4<span class="op">$</span>k<span class="op">/</span><span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## [1] 0.9820 0.8370 0.6845 0.5260</code></pre>
</div>
<div id="gelman-rubin-for-9.4" class="section level2">
<h2>Gelman-Rubin for 9.4</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#定义Gelman-Rubin函数</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>Gel&lt;-<span class="st"> </span><span class="cf">function</span>(psi){</span>
<span id="cb100-3"><a href="#cb100-3"></a>  psi&lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb100-4"><a href="#cb100-4"></a>  n&lt;-<span class="kw">nrow</span>(psi)</span>
<span id="cb100-5"><a href="#cb100-5"></a>  k&lt;-<span class="kw">ncol</span>(psi)</span>
<span id="cb100-6"><a href="#cb100-6"></a>  psi.means&lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)</span>
<span id="cb100-7"><a href="#cb100-7"></a>  B&lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">var</span>(psi.means)</span>
<span id="cb100-8"><a href="#cb100-8"></a>  psi.w&lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>,var)</span>
<span id="cb100-9"><a href="#cb100-9"></a>  W&lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)</span>
<span id="cb100-10"><a href="#cb100-10"></a>  v.hat&lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)</span>
<span id="cb100-11"><a href="#cb100-11"></a>  r.hat&lt;-<span class="st"> </span>v.hat<span class="op">/</span>W</span>
<span id="cb100-12"><a href="#cb100-12"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb100-13"><a href="#cb100-13"></a>}</span>
<span id="cb100-14"><a href="#cb100-14"></a>las&lt;-<span class="st"> </span><span class="cf">function</span>(n,sigma,x_<span class="dv">0</span>,N){</span>
<span id="cb100-15"><a href="#cb100-15"></a>  data&lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> n,<span class="dt">ncol =</span> N)</span>
<span id="cb100-16"><a href="#cb100-16"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb100-17"><a href="#cb100-17"></a>    data[i,]&lt;-<span class="st"> </span><span class="kw">la.Me</span>(sigma,x_<span class="dv">0</span>,N)<span class="op">$</span>x</span>
<span id="cb100-18"><a href="#cb100-18"></a>  }</span>
<span id="cb100-19"><a href="#cb100-19"></a>  <span class="kw">return</span>(data)</span>
<span id="cb100-20"><a href="#cb100-20"></a>}</span>
<span id="cb100-21"><a href="#cb100-21"></a>r&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">500</span>,<span class="dv">10000</span>,<span class="dt">by=</span> <span class="dv">100</span>)</span>
<span id="cb100-22"><a href="#cb100-22"></a>l&lt;-<span class="st"> </span><span class="kw">length</span>(r)</span>
<span id="cb100-23"><a href="#cb100-23"></a>Gelresult&lt;-<span class="kw">numeric</span>(l)</span>
<span id="cb100-24"><a href="#cb100-24"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l) {</span>
<span id="cb100-25"><a href="#cb100-25"></a>  newla&lt;-<span class="st"> </span><span class="kw">las</span>(<span class="dv">20</span>,<span class="fl">0.2</span>,<span class="dv">20</span>,r[i])</span>
<span id="cb100-26"><a href="#cb100-26"></a>  psi&lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(newla,<span class="dv">1</span>,cumsum))</span>
<span id="cb100-27"><a href="#cb100-27"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) {</span>
<span id="cb100-28"><a href="#cb100-28"></a>    psi[j,]&lt;-<span class="st"> </span>psi[j,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb100-29"><a href="#cb100-29"></a>  }</span>
<span id="cb100-30"><a href="#cb100-30"></a>  Gelresult[i]&lt;-<span class="st"> </span><span class="kw">Gel</span>(psi)</span>
<span id="cb100-31"><a href="#cb100-31"></a>}</span>
<span id="cb100-32"><a href="#cb100-32"></a><span class="kw">plot</span>(r,Gelresult,<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span>
<span id="cb100-33"><a href="#cb100-33"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>,<span class="dt">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrAFUrgNRVAABVACtVqv+AKwCAgFWA1P+qVQCq/6qq///UgCvU///fU2v/qlX/1ID//6r//9T///8TGdWiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIK0lEQVR4nO2diXqjNhhF5WmcNp6moSHFDu//oAVkCbFetAUh7plvMtgRv+AMWgAJRE1WEXtvQOpQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAHaCCiGu3+9CiL8jbU56WAkqX74aR9e6ftzeYm1QatgI+n5vtFSXj1qqmg13GGIIetyaklX9+qzVT79wuxJF0JYjyCLcrkQR1NdBnSrvcHsSRxBuxcTMUpJEEmQRjoJAuJMLKmErtr0h3YUfPoJmuhcUBMJREAhHQSAcBYFwZxT0uPWVMVuxOb7fF7zMhDuloMbQdWu4cwqqK3At8fSCtocTaZ9s7C5IJH42RkEACgJQEICCABQEsBf0+P3R/bt0Q8cyXL6Clq4VWobLTVDRn4Z63VReFJSaLfcjKES+IkdBIfOlIBAuP0EbLoXZhMtPUOB8KWgSZXhfrBdktmpJ4dCK3UIXscFRdHxBT/w60iuCEjPkXsQKcNV5S7isBQU5FxMZCwpyLtYLUvGzEfS4BShiWQpSrdjC6Ey7cDkKCprvnKC0FKUmaNBpTAEHQe30gjJWERNWG/UDOAgqXr7ur9cg/aAsBbXzDNo774H7QaaglAy5CSoaOYH7QQM1hxbUlK3H7eVrSz/o/ro4xEMJUkUqJ0FNR+jysToAaPsIswVBCRmK08xX8pbH1iOo0yP7PycRVLeF0FLQoA8kknHkIqgpQS9fBbgtVlw+LATp1j0HQdXlo2wraWCoFG/nFNTOkWsnzMFm/v76BxRUZyio7Qe1gnBH8ft9eSRnxoLUEVR4nYxlLOhZB5XbnhmA5ostCKqTGfvq2IoJcXEawjCZL2YKMo+bQwsKmW+GghZnejvlm6Gg7rEKwfJdEZSGIZdK2u+e6jBchoI23Ju3mi9mfDQFpVLG4lTSNvPFjI/nEWQzX8z4eCJBFvPFjI8ZCAo8BG/0MQNBsfKlIBBuIiiZnqLjuRi+ouiSbyaCNl5RdMlX5CBo8xVFh3yXBe1my+1cbNsVRft8zafmHFZQ2CuKo29zEGR3RdEu3zwE+VxRBPkOzuCPKyhevjsIQoEPIyiWofCCimt9f23KmNcAM1tBq70iL3ehBXWjEtpbyvc/vSqhDYLMNMcRVKhRG/CKj0u+E0HGFVjbWF4b4hBcJpS3NLpBCU49aX2t5L/DYCdI3tLoBMXoSU9aLlGrv5GOIFj5W18w06eoMc7FxoLEFkFeDVxoQcbo6CDjpFe/FvLPsQTpMVGVX1faS9Bw5bQE1ZXsAHmeitkLMn5l7pRITtDz8R1+MzU2ChL1UJB4phkJ8qmlYwgKwpZwz7I1K6jvIPmd9x9akEzXC3qa6EqVFiROLqg/RISqbyhonNAQpH+qAEKIUbB+pMim8PkIUgMZDUFiqyCPTtSRBMnPov9eVdezgsT0u5mcYROYvKB6JMj4R+gqaZBaGOuolEuCxit7bKidoO6tLGsDHAIIMursQeo5QWatVQ9+Mf3acUOtBJXqCXDV0qPgHASNv+2PjEFp6qun55IWJNTHepxmZYOiCDIGwoZ4O9R8RWrsrRltKEgXRN2NSkKQMRA2xPvF5tOOi51ZN80JEvVI0KB8LrZmRziCVpgVpA+N54++aBmlUuwpqD/XD1IHbaDvT8sDSxUqo6YaCBL6j15tYYsitWLwCShRBOlOo3ENSR9c+he9HGOW7E8L+ulwRlvVhxcDQWYyVcB0AmEkEn1Smw1NXJAOO2zQ5vIdVT+qA6BSj8TEFoTfLxaUwbN1lgqNtqMFGceZ6L+w29Awe2T/+lKfzJa2YZRKt39Cd5XEXoJihfPI2nRhHkrzqTeH9SVFQdPfzX6zLawvOwoaAY4XCgJEEWQ/Xyxd4hxB1vPF0iVSEbOdL5YuseogOF/sMEQS5AnMLYUEXsk9SWH/Kcg3gVdyT1LYfwryTeCV3JMU9p+CfBN4Jfckhf2nIN8EXsnPBwUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJEFdSNO+9GM1bqsSnThXXap0Fc3SPc//oEK6MoMQV9vzdZl+3+tTNhu9mw04V1qpcv+dI8twiPW3creGVlGCWmIDlTuPz1KccPF9d6urCOTOYcoZJjCFZWxlHi10HN/482NV1YX1c/ScQpQiXeugHvKyvjKPEFFc1mdPtZzS2sr1v9+vfW1WKuEaSg5ZVxlOiC2jHnspA3P6cL6yuXbRFpR0y4Ruh2fWVlHCW2oErV0W6CLs//4GwFyTkLzkVMVg5NRZFrESvN9205VNJyy5u9cI2QeCWtJr84N/NyAlbl3lGokm7m769qTpBzR7GddtXthGOEKumOYinHcrXZl6pDP11Yp1InK24RnrXLysooCk9WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgOQFPX7/s/yE+B8gfUE33/cN+XEAQX4vePflAIL8XujlCwUBKAhAQQAKAlAQIHlBe0NBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B4EQ/AOQGlt7AAAAAElFTkSuQmCC" /><!-- --></p>
<p>估计在n大于4300后稳定在1.2下</p>
</div>
<div id="section-23" class="section level2">
<h2>11.4</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>a&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb101-2"><a href="#cb101-2"></a>result&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a))</span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>) {</span>
<span id="cb101-4"><a href="#cb101-4"></a>  k&lt;-a[i]</span>
<span id="cb101-5"><a href="#cb101-5"></a>  s&lt;-<span class="st"> </span><span class="cf">function</span>(a){<span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)}</span>
<span id="cb101-6"><a href="#cb101-6"></a>  result[i]&lt;-<span class="st"> </span><span class="kw">uniroot</span>(s,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.01</span>))<span class="op">$</span>root</span>
<span id="cb101-7"><a href="#cb101-7"></a>}</span>
<span id="cb101-8"><a href="#cb101-8"></a><span class="kw">data.frame</span>(<span class="kw">cbind</span>(a,result))</span></code></pre></div>
<pre><code>##       a    result
## 1     4  1.492073
## 2     5  1.533555
## 3     6  1.562745
## 4     7  1.584429
## 5     8  1.601184
## 6     9  1.614516
## 7    10  1.625389
## 8    11  1.634418
## 9    12  1.642026
## 10   13  1.648552
## 11   14  1.654175
## 12   15  1.659099
## 13   16  1.663454
## 14   17  1.667287
## 15   18  1.670733
## 16   19  1.673832
## 17   20  1.676605
## 18   21  1.679148
## 19   22  1.681468
## 20   23  4.785832
## 21   24  4.888979
## 22   25  4.990000
## 23  100  9.990000
## 24  500 22.350680
## 25 1000 31.612777</code></pre>
</div>
</div>
<div id="section-24" class="section level1">
<h1>11.24</h1>
</div>
<div id="me" class="section level1">
<h1>ME</h1>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>L &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>) <span class="co">#initial estimation</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>L.old&lt;-<span class="st"> </span>L</span>
<span id="cb103-4"><a href="#cb103-4"></a>N&lt;-<span class="dv">5</span> <span class="co">#max iter</span></span>
<span id="cb103-5"><a href="#cb103-5"></a>like&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>N</span>
<span id="cb103-6"><a href="#cb103-6"></a>pq&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb103-7"><a href="#cb103-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb103-8"><a href="#cb103-8"></a>  LL &lt;-<span class="st"> </span><span class="cf">function</span>(lam,y){</span>
<span id="cb103-9"><a href="#cb103-9"></a>    lam3&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>lam[<span class="dv">1</span>]<span class="op">-</span>lam[<span class="dv">2</span>]</span>
<span id="cb103-10"><a href="#cb103-10"></a>    f1&lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">132</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">2</span>])<span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">361</span><span class="op">*</span><span class="kw">log</span>(lam3)<span class="op">+</span><span class="dv">63</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">1</span>]<span class="op">*</span>lam[<span class="dv">2</span>])</span>
<span id="cb103-11"><a href="#cb103-11"></a>    L3&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>L[<span class="dv">1</span>]<span class="op">-</span>L[<span class="dv">2</span>]</span>
<span id="cb103-12"><a href="#cb103-12"></a>    f2&lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>L3<span class="op">/</span>(L[<span class="dv">1</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>L3))<span class="op">*</span><span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(lam3<span class="op">/</span>lam[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>L3<span class="op">/</span>(L[<span class="dv">2</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>L3))<span class="op">*</span><span class="dv">132</span><span class="op">*</span><span class="kw">log</span>(lam3<span class="op">/</span>lam[<span class="dv">2</span>])</span>
<span id="cb103-13"><a href="#cb103-13"></a>    f&lt;-<span class="st"> </span>f1<span class="op">+</span>f2</span>
<span id="cb103-14"><a href="#cb103-14"></a>    <span class="kw">return</span>(<span class="op">-</span>f)</span>
<span id="cb103-15"><a href="#cb103-15"></a>  }</span>
<span id="cb103-16"><a href="#cb103-16"></a>  opt&lt;-<span class="st"> </span><span class="kw">optim</span>(L,LL,<span class="dt">y=</span>y)</span>
<span id="cb103-17"><a href="#cb103-17"></a>  L&lt;-<span class="st"> </span>opt<span class="op">$</span>par</span>
<span id="cb103-18"><a href="#cb103-18"></a>  like[i]&lt;-<span class="st"> </span><span class="op">-</span>opt<span class="op">$</span>value</span>
<span id="cb103-19"><a href="#cb103-19"></a>  pq[i,]&lt;-L</span>
<span id="cb103-20"><a href="#cb103-20"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(L<span class="op">-</span>L.old))<span class="op">&lt;</span>tol)<span class="cf">break</span></span>
<span id="cb103-21"><a href="#cb103-21"></a>  L.old&lt;-L</span>
<span id="cb103-22"><a href="#cb103-22"></a>}</span>
<span id="cb103-23"><a href="#cb103-23"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb103-24"><a href="#cb103-24"></a>  <span class="kw">cat</span>(j,<span class="st">&#39;次&#39;</span>)</span>
<span id="cb103-25"><a href="#cb103-25"></a>  <span class="kw">print</span>(<span class="st">&#39;似然比：&#39;</span>)</span>
<span id="cb103-26"><a href="#cb103-26"></a>  <span class="kw">print</span>(like[j])</span>
<span id="cb103-27"><a href="#cb103-27"></a>  <span class="kw">print</span>(<span class="st">&#39;p,q的估计&#39;</span>)</span>
<span id="cb103-28"><a href="#cb103-28"></a>  <span class="kw">print</span>(pq[j,])</span>
<span id="cb103-29"><a href="#cb103-29"></a>}</span></code></pre></div>
<pre><code>## 1 次[1] &quot;似然比：&quot;
## [1] -1726.374
## [1] &quot;p,q的估计&quot;
## [1] 0.2547434 0.1009825
## 2 次[1] &quot;似然比：&quot;
## [1] -1789.984
## [1] &quot;p,q的估计&quot;
## [1] 0.2900680 0.1023675
## 3 次[1] &quot;似然比：&quot;
## [1] -1800.038
## [1] &quot;p,q的估计&quot;
## [1] 0.2963112 0.1026060
## 4 次[1] &quot;似然比：&quot;
## [1] -1801.831
## [1] &quot;p,q的估计&quot;
## [1] 0.2973837 0.1027181
## 5 次[1] &quot;似然比：&quot;
## [1] -1802.159
## [1] &quot;p,q的估计&quot;
## [1] 0.2976292 0.1027139</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>f&lt;-<span class="st"> </span><span class="cf">function</span>(lam){</span>
<span id="cb105-2"><a href="#cb105-2"></a>  lam3&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>lam[<span class="dv">1</span>]<span class="op">-</span>lam[<span class="dv">2</span>]</span>
<span id="cb105-3"><a href="#cb105-3"></a>  f1&lt;-<span class="st"> </span><span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>lam[<span class="dv">1</span>]<span class="op">*</span>lam3)<span class="op">+</span><span class="dv">132</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>lam[<span class="dv">2</span>]<span class="op">*</span>lam3)</span>
<span id="cb105-4"><a href="#cb105-4"></a>  f2&lt;-<span class="st"> </span><span class="dv">63</span><span class="op">*</span><span class="kw">log</span>(lam[<span class="dv">1</span>]<span class="op">*</span>lam[<span class="dv">2</span>])<span class="op">+</span><span class="st"> </span><span class="dv">361</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(lam3)</span>
<span id="cb105-5"><a href="#cb105-5"></a>  <span class="kw">return</span>(<span class="op">-</span>(f1<span class="op">+</span>f2))</span>
<span id="cb105-6"><a href="#cb105-6"></a>}</span>
<span id="cb105-7"><a href="#cb105-7"></a><span class="co">#极大似然估计</span></span>
<span id="cb105-8"><a href="#cb105-8"></a><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.1</span>),f)<span class="op">$</span>par</span></code></pre></div>
<pre><code>## [1] 0.2976126 0.1027036</code></pre>
<div id="p204-3" class="section level2">
<h2>p204 3</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>f &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb107-2"><a href="#cb107-2"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb107-3"><a href="#cb107-3"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb107-4"><a href="#cb107-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb107-5"><a href="#cb107-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb107-6"><a href="#cb107-6"></a>)</span>
<span id="cb107-7"><a href="#cb107-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb107-8"><a href="#cb107-8"></a>  p &lt;-<span class="st"> </span><span class="kw">parse</span>(<span class="dt">text =</span> f[i])[[<span class="dv">1</span>]]</span>
<span id="cb107-9"><a href="#cb107-9"></a>  fit&lt;-<span class="st"> </span><span class="kw">lm</span>(p,<span class="dt">data=</span>mtcars)</span>
<span id="cb107-10"><a href="#cb107-10"></a>  <span class="kw">print</span>(fit)</span>
<span id="cb107-11"><a href="#cb107-11"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = p, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = p, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = p, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = p, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="kw">lapply</span>(f,<span class="cf">function</span>(x){<span class="kw">lm</span>(x,<span class="dt">data =</span> mtcars)})</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="p213-3" class="section level2">
<h2>p213 3</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb111-2"><a href="#cb111-2"></a>  <span class="dv">100</span>,</span>
<span id="cb111-3"><a href="#cb111-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb111-4"><a href="#cb111-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb111-5"><a href="#cb111-5"></a>)</span>
<span id="cb111-6"><a href="#cb111-6"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x){<span class="kw">return</span>(x<span class="op">$</span>p.value)})</span></code></pre></div>
<pre><code>##   [1] 0.33350859 0.72280736 0.10215113 0.62771301 0.63464643 0.41434572
##   [7] 0.89981894 0.64758106 0.84242462 0.11403886 0.08387984 0.07434339
##  [13] 0.15135347 0.55491586 0.06522973 0.88609804 0.09427698 0.67653800
##  [19] 0.04964828 0.51543061 0.37070147 0.34063682 0.53028335 0.71968639
##  [25] 0.28057986 0.90900574 0.09197786 0.28036481 0.15689347 0.80143062
##  [31] 0.98564938 0.78387783 0.86920107 0.36007035 0.44490270 0.42509524
##  [37] 0.02640738 0.65833924 0.21908421 0.21835206 0.19566389 0.23786357
##  [43] 0.75711229 0.34656631 0.68722194 0.06365324 0.97711803 0.55780991
##  [49] 0.02307376 0.64987600 0.71233506 0.47770470 0.62898443 0.77947848
##  [55] 0.81988420 0.99490481 0.79576498 0.06894024 0.44148606 0.26670847
##  [61] 0.64452859 0.17807032 0.43774678 0.63593616 0.23969278 0.47789230
##  [67] 0.33595624 0.52772151 0.72673724 0.59119873 0.92958565 0.34722105
##  [73] 0.44695044 0.43333636 0.18235531 0.22205632 0.14048186 0.22547811
##  [79] 0.08940749 0.41932612 0.96717954 0.10639226 0.28962584 0.56649831
##  [85] 0.19573949 0.80955299 0.47634046 0.70500275 0.83298176 0.90186788
##  [91] 0.58540099 0.52517119 0.87769152 0.97178038 0.29759697 0.15397670
##  [97] 0.05378379 0.67009978 0.92409954 0.92832944</code></pre>
</div>
<div id="p214-6" class="section level2">
<h2>p214 6</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>lapply1&lt;-<span class="cf">function</span>(X,funct,t){</span>
<span id="cb113-2"><a href="#cb113-2"></a>  <span class="kw">Map</span>(<span class="cf">function</span>(x){<span class="kw">vapply</span>(x, funct,t)},X)</span>
<span id="cb113-3"><a href="#cb113-3"></a>} </span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="co">#其中t为输出类型，X是输入列表的列表，funct是函数</span></span>
<span id="cb113-5"><a href="#cb113-5"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb113-6"><a href="#cb113-6"></a>  <span class="dv">6</span>,</span>
<span id="cb113-7"><a href="#cb113-7"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb113-8"><a href="#cb113-8"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb113-9"><a href="#cb113-9"></a>)</span>
<span id="cb113-10"><a href="#cb113-10"></a>trials1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb113-11"><a href="#cb113-11"></a>  <span class="dv">5</span>,</span>
<span id="cb113-12"><a href="#cb113-12"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb113-13"><a href="#cb113-13"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb113-14"><a href="#cb113-14"></a>)</span>
<span id="cb113-15"><a href="#cb113-15"></a>X&lt;-<span class="st"> </span><span class="kw">list</span>(trials,trials1)</span>
<span id="cb113-16"><a href="#cb113-16"></a><span class="kw">lapply1</span>(X,<span class="cf">function</span>(x){<span class="kw">return</span>(x<span class="op">$</span>p.value)},<span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.4783229 0.4751261 0.5997565 0.3529811 0.5876717 0.2663979
## 
## [[2]]
## [1] 0.7633297 0.9667008 0.5003538 0.6547896 0.7675956</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="co">#函数输出效果</span></span></code></pre></div>
</div>
<div id="section-25" class="section level2">
<h2>1</h2>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">library</span>(StatComp20089)</span>
<span id="cb116-2"><a href="#cb116-2"></a></span>
<span id="cb116-3"><a href="#cb116-3"></a>sigma=<span class="dv">1</span></span>
<span id="cb116-4"><a href="#cb116-4"></a>x_<span class="dv">0</span>=<span class="dv">0</span></span>
<span id="cb116-5"><a href="#cb116-5"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb116-6"><a href="#cb116-6"></a></span>
<span id="cb116-7"><a href="#cb116-7"></a>la.Me&lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x_<span class="dv">0</span>,N){</span>
<span id="cb116-8"><a href="#cb116-8"></a>  x&lt;-<span class="st"> </span><span class="kw">numeric</span>(N)<span class="co">#链</span></span>
<span id="cb116-9"><a href="#cb116-9"></a>  x[<span class="dv">1</span>]&lt;-<span class="st"> </span>x_<span class="dv">0</span></span>
<span id="cb116-10"><a href="#cb116-10"></a>  u&lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb116-11"><a href="#cb116-11"></a>  k&lt;-<span class="st"> </span><span class="dv">0</span><span class="co">#拒绝</span></span>
<span id="cb116-12"><a href="#cb116-12"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb116-13"><a href="#cb116-13"></a>    y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb116-14"><a href="#cb116-14"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y))<span class="op">/</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>]))))</span>
<span id="cb116-15"><a href="#cb116-15"></a>      x[i]&lt;-<span class="st"> </span>y <span class="cf">else</span>{</span>
<span id="cb116-16"><a href="#cb116-16"></a>        x[i]&lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb116-17"><a href="#cb116-17"></a>        k&lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb116-18"><a href="#cb116-18"></a>      }</span>
<span id="cb116-19"><a href="#cb116-19"></a>  }</span>
<span id="cb116-20"><a href="#cb116-20"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">k=</span>N<span class="op">-</span>k))</span>
<span id="cb116-21"><a href="#cb116-21"></a>}</span>
<span id="cb116-22"><a href="#cb116-22"></a>x1=<span class="kw">la.Me</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2000</span>)<span class="op">$</span>x</span>
<span id="cb116-23"><a href="#cb116-23"></a></span>
<span id="cb116-24"><a href="#cb116-24"></a>x2=<span class="kw">cla</span>(sigma,x_<span class="dv">0</span>,N)</span>
<span id="cb116-25"><a href="#cb116-25"></a></span>
<span id="cb116-26"><a href="#cb116-26"></a><span class="kw">plot</span>(x1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="kw">plot</span>(x2,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>红色图是R，绿色是rcpp。</p>
</div>
<div id="section-26" class="section level2">
<h2>2</h2>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>Rf =<span class="st"> </span>x1[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb118-2"><a href="#cb118-2"></a>Rcppf =<span class="st"> </span>x2[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>)]</span>
<span id="cb118-3"><a href="#cb118-3"></a><span class="kw">qqplot</span>(Rf,Rcppf)</span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrKysrgNRVAABVACtVqv+AKwCAVQCA1P+qVQCq/6qq///UgCvUgIDU1IDU////AAD/qlX/1ID//6r//9T///+yZxZLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIM0lEQVR4nO2di3ajNhRFlWkm07jjTlra4tj8/3c2QmDAljh6omt89prHWh75Cu+5uhKGCNWRVVTtA5AOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCZBakqtN6tqslKG+4cFrUYHDzrIKwn9lvL3YlqPXy0//5lIKgnicX5OHn6/h0DXpOQT75Yyr0c9Ygt59xWp9m+CfMoJXyPNMzS6EnE7QyvPqEMW66vgZ15QV9vv3MGS6dtfKjhl+DIKUK1qDzYVqpf/s7OVw21ofXJEhdx1upDDqpd/2XsAy68zMvxt2gZRhl13OwQkPsfHj9zyYo/BwwHzd+Zkei5i90Cz/latDHyy9RGTRMX7dn6sOcNf7T/fvKFelGvQsSNKTPOKKuU/lckPWNBWexz7ffxAia/AynEGOhmcaY44hKTvOXoxIiaJ4/g55J0DS323iKheLCz3KMwQlj/4JU205FeGHIazLdtyCtoJ0tdJZzmNcx7FmQGvx006Aav+UJCJK9YZVw1i7G/JmKcrifHQua/MxmrfA1/G4FzfwMVmL07FTQIKVtl1kT42ePgkYpN3pio2VvWCXcLPC40mnT5fTxsjesEm6Ke5M/6QGzN6wS7ho2t5+dCbrqyeZnn4Ly6dmXoNnwyhg0e8Mq4fqQJfxsLehaRPMLKuMnVND58PP8x68t+/WNV8hPuKB3iYImPbn9BA+xZhokjmummfv1CjZf/eQM3MXUIHkZVNLPLmaxUuXHBI9o2N+boC8tb9GvR6iSfmIEnV70GGtekkZavs9SrDwP4YMbXo7mauBHUg5l+zBF06dLKdInEbNYaT8JGdRIyKDifqJqUH/FvXFfd8/a73qU4n5ihhi+vy5nv6tByvt56HVQ2elr7CR7w83ClVs9L3qJaChkobiJn8ddKE75I02Q10LxcgRVPPVTbeWn0EKxMfdJX2+YTujX8faxPBe/n7jIQvFyvGpxtUq7HDylT/mbIMIb4oXi+XD9t5s8m5ZQQUd5cygb+imzUCyaQWpTP4XWQdf0yl+DNvZTaqE4ppmzTkV+NjX3ExcitMeIhnqCd6ZG7n4Xbxr1bOcnRpBZAJ0P3zfpd/6erYdX32lww3GK2vwLs+2HV99rcMNximo2FlTHT8wQM1PU51tSEQr9iGruJ6XjUGKK9Ofb10GmnauGClqU56SOQ3mM74NqpU+XJOifrWrQfHgldBlHsKBmOMG4HDcq0qqqn2BB+tsys1BMWyn69qsq+wkVdDl+71dCzUZFurqfiBuotKXfVdIy2rvfmZ62ip4IQXoN9JF4IubXr6qfPl2soMRLGl79yvATKSh1gHn0u/ST3F80QgWphZ/k3hKQKWihp6qfcEHTkccsFKd3+7WqnD6d0HMxQX4kCprp8drysCzSBC2qswA/0gSJ8yNL0EJP7elrQJKgGz95O4xFjiAl0o8cQUL9iBG02NvHb0fjbRAkaNoUSkZ5NsgRNBqSlD6dHEG9IXOGJsqPFEGzE1hZfoQI6tPHvCjMT1lBvluVqumXND9lBIXuJ30VJGn6GiiTQYH7SY+709X87tlFoSHm2k/aEc7UIIl+ytWgkP2kh7MLiX4KFumA/aQF+yk5i9n2k56fb81e1OW53rXBVUpO8777SZv0eUpB7kv4Y7ix/NwklRwqC1JT/sj0U1mQ6n/n3JMtOwIEtTG7GG9GdUHtsGO4UD+1z+b1d8+SB1hlQVVufA6kpiD95YZwPVUFmS9/pBuqKMh8+UNBrnDtNNNLppqgdqxDwqklyAwv6VNYV30dJJ9qgh6GSoK84zv7DX1DtkB5mgdDQZHxKQjEpyAQn4JAfAoC8SkIxKcgEJ+C9gIFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCbCAoYFuik30jx34rfcddW/boek9I21Yt+kl8YY+eKS/o5P8oCr3V3One0OX49Vpj3z7MHv309aJt2179zIdTmKHigs4Hb0Hm3r77TXrMnf3WTWbt0U2g+zf0e9kF7gJUXFDz+qevoBURXWdLLVf0zx/2vfwkCvo6Vu8aZD6Xa7/mD8vrjuinb38drEVL3hDTye4tyOSINVPs2+i7ojf65/1MutxFCd0psrAg/fSELIJOthrtim6ev2NJRZ2FgRtClxXUD5ocQ8y6174zuilj9z+1tV7k7BQTpFcc7+MDgP1Gvfv4G+sqyBndOL4v1atj2IGkhaJrml99XIwtutnU7z4Vzf9A2K79kgS5FoqrVcMaXRcn209MiKtBPQGnGo11khmGkn1k2KOfHOcmH+5zFgc8WQVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAJIF9Xf/DhfTm8RnLEcjW1B/J4y+qbB/lHAVHkCQ/svc8VODBxDUfbz++xb39M4MPIAgZpCLQVDT1yAKumecxX52FGSlz6DPN51GFGTDDLH+FmkKsjHUIP2sEwqyMQjSz8uhIBvjOqhR7xQkFgoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/P8xomMsE4QwAAAAASUVORK5CYII=" /><!-- --></p>
<p>发现基本在对角线上分布，所以可以认为同分布。</p>
</div>
<div id="section-27" class="section level2">
<h2>3</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb119-2"><a href="#cb119-2"></a></span>
<span id="cb119-3"><a href="#cb119-3"></a>(<span class="dt">time =</span> <span class="kw">microbenchmark</span>(<span class="dt">Rf=</span><span class="kw">la.Me</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2000</span>)<span class="op">$</span>x,<span class="dt">Rcppf=</span><span class="kw">cla</span>(sigma,x_<span class="dv">0</span>,N)))</span></code></pre></div>
<pre><code>## Unit: microseconds
##   expr    min      lq     mean  median      uq     max neval
##     Rf 4100.1 5543.45 7022.318 6571.85 7421.55 17937.8   100
##  Rcppf  362.4  447.20  498.856  498.60  520.00  1015.0   100</code></pre>
</div>
<div id="section-28" class="section level2">
<h2>4</h2>
<p>可以看出来rcpp和r得到的结果基本一致，但是rcpp的速度更加快。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
