"0","L <- c(0.01,0.1) #initial estimation"
"0","tol <- .Machine$double.eps^0.5"
"0","L.old<- L"
"0","N<-5 #max iter"
"0","like<- 1:N"
"0","pq<-matrix(0,N,2)"
"0","for (i in 1:N) {"
"0","  LL <- function(lam,y){"
"0","    lam3<- 1- lam[1]-lam[2]"
"0","    f1<- 2*444*log(lam[1]) + 2*132*log(lam[2])+ 2*361*log(lam3)+63*log(lam[1]*lam[2])"
"0","    L3<- 1-L[1]-L[2]"
"0","    f2<- (2*L3/(L[1]+2*L3))*444*log(lam3/lam[1]) + (2*L3/(L[2]+2*L3))*132*log(lam3/lam[2])"
"0","    f<- f1+f2"
"0","    return(-f)"
"0","  }"
"0","  opt<- optim(L,LL,y=y)"
"0","  L<- opt$par"
"0","  like[i]<- -opt$value"
"0","  pq[i,]<-L"
"0","  if(sum(abs(L-L.old))<tol)break"
"0","  L.old<-L"
"0","}"
"0","for (j in 1:i) {"
"0","  cat(j)"
"0","  print('似然比：')"
"0","  print(like[j])"
"0","  print('p,q')"
"0","  print(pq[j,])"
"0","}"
"1","1"
"1","[1]"
"1"," ""似然比："""
"1","
"
"1","[1]"
"1"," -1726.374"
"1","
"
"1","[1]"
"1"," ""p,q"""
"1","
"
"1","[1]"
"1"," 0.2547434"
"1"," 0.1009825"
"1","
"
"1","2"
"1","[1]"
"1"," ""似然比："""
"1","
"
"1","[1]"
"1"," -1789.984"
"1","
"
"1","[1]"
"1"," ""p,q"""
"1","
"
"1","[1]"
"1"," 0.2900680"
"1"," 0.1023675"
"1","
"
"1","3"
"1","[1]"
"1"," ""似然比："""
"1","
"
"1","[1]"
"1"," -1800.038"
"1","
"
"1","[1]"
"1"," ""p,q"""
"1","
"
"1","[1]"
"1"," 0.2963112"
"1"," 0.1026060"
"1","
"
"1","4"
"1","[1]"
"1"," ""似然比："""
"1","
"
"1","[1]"
"1"," -1801.831"
"1","
"
"1","[1]"
"1"," ""p,q"""
"1","
"
"1","[1]"
"1"," 0.2973837"
"1"," 0.1027181"
"1","
"
"1","5"
"1","[1]"
"1"," ""似然比："""
"1","
"
"1","[1]"
"1"," -1802.159"
"1","
"
"1","[1]"
"1"," ""p,q"""
"1","
"
"1","[1]"
"1"," 0.2976292"
"1"," 0.1027139"
"1","
"
"0","f<- function(lam){"
"0","  lam3<- 1-lam[1]-lam[2]"
"0","  f1<- 444*log(lam[1]^2+2*lam[1]*lam3)+132*log(lam[2]^2+2*lam[2]*lam3)"
"0","  f2<- 63*log(lam[1]*lam[2])+ 361*2*log(lam3)"
"0","  return(-(f1+f2))"
"0","}"
"0","#极大似然估计"
"0","optim(c(0.3,0.1),f)$par"
"1","[1]"
"1"," 0.2976126"
"1"," 0.1027036"
"1","
"
