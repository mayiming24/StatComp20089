"0","n<-30"
"0","m<-200"
"0","Sigma <- matrix(c(1,0,0,1),2,2)"
"0","epsilon<-seq(0,1,0.01)"
"0","el<- length(epsilon)"
"0","mskpwr<-1:el"
"0","cv<-c((6/n)*qchisq(0.05,4),(6/n)*qchisq(0.95,4))"
"0","for (i in 1:el) {"
"0","  e<-epsilon[i]"
"0","  mskt<- numeric(m)"
"0","  for (j in 1:m) {"
"0","    k<- sample(c(0,1),replace = TRUE,size = n,prob = c(e,1-e))"
"0","    z<-matrix(0,20,2)"
"0","    x<- mvrnorm(n, rep(0, 2), Sigma)"
"0","    y<- mvrnorm(n, rep(0,2), 4*Sigma)"
"0","    for (h in 1:20) {"
"0","      if(k[h]==0)"
"0","        z[h,]<-x[h,]else"
"0","          z[h,]<-y[h,]"
"0","    }"
"0","    v<- msk(z)"
"0","    if(v<cv[1]|v>cv[2])"
"0","      mskt[j]<-1 else"
"0","        mskt[j]<- 0"
"0","  }"
"0","  mskpwr[i]<- mean(mskt)"
"0","}"
"0"," plot(epsilon,mskpwr,type = ""l"",ylim = c(0,0.5))"
