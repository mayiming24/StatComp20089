"0","#定义Gelman-Rubin函数"
"0","Gel<- function(psi){"
"0","  psi<- as.matrix(psi)"
"0","  n<-nrow(psi)"
"0","  k<-ncol(psi)"
"0","  psi.means<- rowMeans(psi)"
"0","  B<- n*var(psi.means)"
"0","  psi.w<- apply(psi, 1,var)"
"0","  W<- mean(psi.w)"
"0","  v.hat<- W*(n-1)/n + (B/n)"
"0","  r.hat<- v.hat/W"
"0","  return(r.hat)"
"0","}"
"0","las<- function(n,sigma,x_0,N){"
"0","  data<- matrix(0,nrow = n,ncol = N)"
"0","  for (i in 1:n) {"
"0","    data[i,]<- la.Me(sigma,x_0,N)$x"
"0","  }"
"0","  return(data)"
"0","}"
"0","r<- seq(500,10000,by= 500)"
"0","l<- length(r)"
"0","Gelresult<-numeric(l)"
"0","for (i in 1:l) {"
"0","  newla<- las(20,0.2,20,r[i])"
"0","  psi<- t(apply(newla,1,cumsum))"
"0","  for (j in 1:nrow(psi)) {"
"0","    psi[j,]<- psi[j,]/(1:ncol(psi))"
"0","  }"
"0","  Gelresult[i]<- Gel(psi)"
"0","}"
"0","plot(r,Gelresult,type = 'l')"
